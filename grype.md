Here’s a structured and concise guide for **Grype**, mimicking the style used for Helm, Molecule, and Checkov:

# Grype

Grype is a vulnerability scanner for container images and filesystems. It detects vulnerabilities in container images, SBOMs, directories, and other supported formats.

#platform/multiple #target/Security #cat/DevOps

% grype, security scanning, vulnerabilities, container images

## Grype - Scan a Docker Image

Scan an image from Docker Hub for vulnerabilities.

```
grype nginx
```

For images on other registries, specify the registry in the image name.

```
grype cgr.dev/chainguard/nginx
```

## Grype - Scan a .tar File

To scan a `.tar` file created from a Docker image:

```
docker pull cgr.dev/chainguard/nginx
docker save cgr.dev/chainguard/nginx > nginx_chainguard_image.tar.gz
grype nginx_chainguard_image.tar.gz
```

## Grype - Scan a Local Directory

Scan a local directory, such as a Python virtual environment or a `node_modules` folder.

First, create a Python virtual environment and install packages:

```
python -m venv venv
./venv/bin/pip install WTForms==2.3.3 Werkzeug==2.0.1
grype venv
```

Similarly, for a Node.js project:

```
mkdir node_project && cd node_project
npm init -y
npm install qs@6.5.2
grype .
```

## Grype - Scan from an SBOM

Grype can read vulnerability data from a Software Bill of Materials (SBOM) generated by Syft. 

First, generate an SBOM using Syft:

```
syft -o syft-json python > sbom.json
```

Then, pipe the SBOM into Grype:

```
cat sbom.json | grype
```

## Grype - Comprehend Scan Results

By default, Grype’s output is divided into two sections: 
1. Summary of the scanned artifact.
2. A list of vulnerabilities (CVEs).

You can scan an older Python image, for example:

```
grype python:3.10.14-alpine3.20
```

